<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>🎂 8-Bit Birthday Adventure</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0f1021;
      --fg:#fdfdfd;
      --accent:#ff6b6b;
      --accent2:#5eead4;
      --gold:#ffd166;
      --shadow:#0a0b17;
      --ink:#2a2c5a;
      --card:#171833;
    }
    *{box-sizing:border-box}
    html,body{height:100%; margin:0;}
    body{
      font-family:'Press Start 2P', system-ui, sans-serif;
      background:linear-gradient(180deg, #0b0c1b 0%, var(--bg) 60%);
      color:var(--fg);
      display:flex;
      justify-content:center;
      /* Key change: don't vertically center tall content by default */
      align-items:flex-start;
    }
.frame{
  width:100%;
  max-width:560px;
  min-height:calc(var(--vh, 1vh) * 100); /* uses JS var below */
  padding:16px;
  display:flex;
  flex-direction:column;
  gap:16px;
}
    .card{background:var(--card);border:4px solid var(--ink);box-shadow:0 6px 0 var(--shadow);border-radius:8px;padding:18px;}
    .title{font-size:22px;line-height:1.3;text-align:center;}
    .subtitle{font-size:12px;opacity:.9;text-align:center;}
    .pixel-btn{display:inline-block;text-align:center;text-decoration:none;cursor:pointer;background:var(--accent);color:#1b0a0a;padding:14px 16px;border:4px solid #b84141;box-shadow:0 6px 0 #7a2626;border-radius:6px;font-size:14px;width:100%;}
    .pixel-btn.secondary{background:#9ca3af;border-color:#6b7280;box-shadow:0 6px 0 #4b5563;color:#0b0c10;}
    .pixel-btn:active{transform:translateY(2px);box-shadow:0 4px 0 #7a2626;}
    .secondary:active{box-shadow:0 4px 0 #4b5563;}
    .pill{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border:3px solid var(--ink);border-radius:999px;font-size:10px;background:#0f1130;}
    .tog{cursor:pointer;user-select:none;}
    .center{display:flex;gap:8px;align-items:center;justify-content:center;flex-wrap:wrap;}
    .footer{text-align:center;font-size:10px;opacity:.75;}
    .screen{display:none;}
    .screen.active{display:block;}
    .divider{display:flex;align-items:center;gap:8px;justify-content:center;opacity:.9;}
    .heart{width:18px;height:18px;background:var(--accent);position:relative;transform:rotate(45deg);}
    .heart:before,.heart:after{content:"";position:absolute;width:18px;height:18px;background:var(--accent);border-radius:50%;}
    .heart:before{left:-9px;}
    .heart:after{top:-9px;}
.q {
  margin: 20px 0;          /* ✅ More space between questions */
  padding-bottom: 6px;     /* ✅ Adds visual separation */
  border-bottom: 1px dashed rgba(255,255,255,0.1); /* subtle divider */
}
.opt {
  display: block;
  padding: 14px 16px;
  border: 3px solid var(--ink);
  border-radius: 8px;
  margin-top: 10px;
  background: #0f1130;
  font-size: 12px;
  line-height: 1.6;        /* ✅ Better readability */
  letter-spacing: 0.2px;   /* ✅ Slight spacing for pixel font */
  word-break: break-word;  /* ✅ Handles long sentences properly */
  white-space: normal;     /* ✅ Allows wrapping naturally */
  text-align: left;        /* ✅ Align text cleanly for multiline */
}
    .opt.correct{border-color:#34d399;}
    .opt.wrong{border-color:#fb7185;}
    .quest-wrap{display:grid;grid-template-rows:auto auto;gap:10px;}
    .quest-map{display:grid;grid-template-columns:repeat(8,1fr);gap:6px;padding:6px;background:#10122f;border:4px solid var(--ink);border-radius:8px;}
    .tile{aspect-ratio:1/1;background:#1b1d45;border:3px solid #2d316a;border-radius:6px;position:relative;overflow:hidden;}
    .tile.goal{background:#1a2b18;border-color:#2f6b35;}
    .sprite{width:70%;height:70%;background:linear-gradient(90deg,#5eead4 0%,#93c5fd 100%);border:3px solid #0b1b3a;border-radius:4px;position:absolute;inset:0;margin:auto;}
    .msg{font-size:11px;text-align:center;opacity:.95;}
    .controls{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;}
    .controls .pixel-btn{padding:10px 0;font-size:12px;}
    .grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;}
    .box{background:#1a1b3c;border:4px solid #303274;border-radius:8px;padding:12px;aspect-ratio:1/1;display:flex;align-items:center;justify-content:center;position:relative;}
    .box.revealed{background:#10122f;border-color:#4ade80;}
    .lid{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;}
    .lid .ribbon{width:70%;height:12px;background:var(--gold);box-shadow:0 3px 0 #b88a1f;}
    .lid .bow{position:absolute;top:18px;width:24px;height:24px;background:var(--accent2);transform:rotate(45deg);}
    .gift{font-size:10px;text-align:center;line-height:1.5;padding:8px;}
    @media(min-width:480px){.title{font-size:26px}.gift{font-size:12px}}
  </style>
</head>
<body>
  <main class="frame" id="app">

    <div class="card center" style="gap:8px;">
      <span class="pill">❤️ x <span id="lives">3</span></span>
      <span class="pill">Level <span id="level">1</span>/3</span>
      <span class="pill tog" id="sfxToggle">🔊 SFX: Off</span>
      <span class="pill tog" id="bgmToggle">🎶 Music: On</span>
    </div>

    <!-- Welcome -->
    <section class="card screen active" id="screen-welcome">
      <div class="title">HAPPY BIRTHDAY ANNIE 🎉</div>
      <p class="subtitle">Ready to play?</p>
      <div class="divider" style="margin:12px 0 18px;">
        <div class="heart"></div><div class="heart"></div><div class="heart"></div>
      </div>
      <button class="pixel-btn" id="btn-start">OH YEAH!</button>
      <p class="footer">Tap to begin — speakers up 🔊</p>
    </section>

    <!-- Level 1: Quiz -->
    <section class="card screen" id="screen-quiz">
      <div class="title">LEVEL 1: QUIZ</div>
      <p class="subtitle">Get 6/6 to unlock the treasure!</p>

      <div class="q" data-answer="c">
        <div style="font-size:12px">Perfect cozy night:</div>
        <label class="opt"><input type="radio" name="q1" value="a"> Movie marathon and takeout 🍿</label>
        <label class="opt"><input type="radio" name="q1" value="b"> Wine night that turns into karaoke 🎤</label>
        <label class="opt"><input type="radio" name="q1" value="c"> Home-made dinner, <em>The Resident</em>, fruitmerge in bed 🍓</label>
      </div>

      <div class="q" data-answer="a">
        <div style="font-size:12px">Our top superpower as a duo:</div>
        <label class="opt"><input type="radio" name="q2" value="a"> Reading each other’s moods — knowing when to comfort and when to tease 💕🫶</label>
        <label class="opt"><input type="radio" name="q2" value="b"> Turning small moments into laughter, stories, and memories that never fade 😂✨</label>
        <label class="opt"><input type="radio" name="q2" value="c"> Balancing chaos and calm — always finding our rhythm in any kind of day ☯️💫</label>
      </div>

      <div class="q" data-answer="b">
        <div style="font-size:12px">What do I appreciate most about you?</div>
        <label class="opt"><input type="radio" name="q3" value="a"> Your chaotic genius — somehow balancing brilliance, snacks, and sass 🧠🍓</label>
        <label class="opt"><input type="radio" name="q3" value="b"> Your kindness — the way you love, listen, and lift everyone around you 💖</label>
        <label class="opt"><input type="radio" name="q3" value="c"> Your fearless honesty — you’ll roast me, hype me, and love me all at once 🔥😅</label>
      </div>

      <div class="q" data-answer="c">
        <div style="font-size:12px">What's your ideal date?</div>
        <label class="opt"><input type="radio" name="q4" value="a"> Sushi dinner date 🍣</label>
        <label class="opt"><input type="radio" name="q4" value="b"> Mini Putt ⛳</label>
        <label class="opt"><input type="radio" name="q4" value="c"> Piano Café retreat 🎹</label>
      </div>

      <div class="q" data-answer="a">
        <div style="font-size:12px">Which artist do you like the best?</div>
        <label class="opt"><input type="radio" name="q5" value="a"> Beach Fossils 🎵</label>
        <label class="opt"><input type="radio" name="q5" value="b"> M83 🌌</label>
        <label class="opt"><input type="radio" name="q5" value="c"> Of Monsters and Men 🐺</label>
      </div>

      <div class="q" data-answer="d">
        <div style="font-size:12px">What do you think I think is your favourite type of gift?</div>
        <label class="opt"><input type="radio" name="q6" value="a"> Home-made trinkets ✂️</label>
        <label class="opt"><input type="radio" name="q6" value="b"> Affection, care, and soul food 💞</label>
        <label class="opt"><input type="radio" name="q6" value="c"> Experiences together 🌅</label>
        <label class="opt"><input type="radio" name="q6" value="d"> All of the above ✨</label>
      </div>

      <button class="pixel-btn" id="btn-quiz">Unlock ➜</button>
      <p id="quiz-result" class="subtitle" style="text-align:center; margin-top:10px; opacity:.85;"></p>
    </section>

    <!-- Level 2: Mini Quest -->
    <section class="card screen" id="screen-quest">
      <div class="title">LEVEL 2: MINI QUEST</div>
      <p class="subtitle">Guide our little duo to the glowing portal.</p>
      <div class="quest-wrap">
        <div class="quest-map" id="questMap"></div>
        <div class="controls">
          <button class="pixel-btn" id="up">▲</button>
          <button class="pixel-btn" id="right">►</button>
          <button class="pixel-btn" id="left">◄</button>
          <button class="pixel-btn" id="down">▼</button>
          <button class="pixel-btn secondary" id="qHint">💬 Hint</button>
          <button class="pixel-btn secondary" id="qReset">↺ Reset</button>
        </div>
        <div class="card msg" id="qMsg">“You’re my favorite adventure buddy.”</div>
      </div>
    </section>

    <!-- Level 3: Finale -->
    <section class="card screen" id="screen-final">
      <div class="title">LEVEL 3: FINAL REVEAL</div>
      <p class="subtitle">Tap each gift box to reveal what’s inside.</p>
      <div class="grid" style="margin-top:12px;">
        <div class="box"><div class="lid"><div class="ribbon"></div><div class="bow"></div></div><div class="gift" hidden>🎵 <strong>Beach Fossils</strong><br/>Live in concert — two tickets for us!</div></div>
        <div class="box"><div class="lid"><div class="ribbon"></div><div class="bow"></div></div><div class="gift" hidden>🎹 <strong>Piano Café &amp; Inn</strong><br/>Dinner + <u>2-night stay</u> booked ✨</div></div>
        <div class="box"><div class="lid"><div class="ribbon"></div><div class="bow"></div></div><div class="gift" hidden>🃏 <strong>Pokémon Card</strong><br/>A special pull just for you.</div></div>
        <div class="box"><div class="lid"><div class="ribbon"></div><div class="bow"></div></div><div class="gift" hidden>✂️ <strong>Hand-made</strong><br/>A custom DIY surprise crafted by me.</div></div>
      </div>
      <div class="card" style="margin-top:14px;">
        <p class="subtitle" style="margin:0">All four revealed? Tap below!</p>
        <button class="pixel-btn" id="btn-end">Click to reveal your gifts!</button>
      </div>
    </section>

    <p class="footer">© Us, <span id="year"></span> • Built with love in 8-bit</p>
  </main>

  <audio id="bg-music" preload="auto" playsinline loop>
    <source src="backgroundmusic.mp3" type="audio/mpeg">
  </audio>
  <audio id="sfx-coin" preload="auto"><source src="https://cdn.jsdelivr.net/gh/naptha/tiny-sfx/coin.ogg" type="audio/ogg" /></audio>
  <audio id="sfx-open" preload="auto"><source src="https://cdn.jsdelivr.net/gh/naptha/tiny-sfx/powerup.ogg" type="audio/ogg" /></audio>
  <audio id="sfx-error" preload="auto"><source src="https://cdn.jsdelivr.net/gh/naptha/tiny-sfx/hit.ogg" type="audio/ogg" /></audio>

  <script>
    const $=(s,r=document)=>r.querySelector(s);const $$=(s,r=document)=>Array.from(r.querySelectorAll(s));
    const screens=['welcome','quiz','quest','final'];let current=0,sfxOn=false,bgmOn=true;
    const sfx={coin:$('#sfx-coin'),open:$('#sfx-open'),error:$('#sfx-error')};
    function play(n){if(!sfxOn)return;const a=sfx[n];a.currentTime=0;a.play();}
    const bgMusic=$('#bg-music');bgMusic.volume=0.4;async function startMusic(){if(bgmOn){try{await bgMusic.play();}catch{}}}
    function show(i){$$('.screen').forEach(e=>e.classList.remove('active'));$(`#screen-${screens[i]}`).classList.add('active');$('#level').textContent=i===0?1:i;scrollTo({top:0,behavior:'smooth'});}
    $('#sfxToggle').onclick=()=>{sfxOn=!sfxOn;$('#sfxToggle').textContent=`🔊 SFX: ${sfxOn?'On':'Off'}`;if(sfxOn)play('coin');};
    $('#bgmToggle').onclick=async()=>{bgmOn=!bgmOn;$('#bgmToggle').textContent=`🎶 Music: ${bgmOn?'On':'Off'}`;if(bgmOn)await startMusic();else bgMusic.pause();};
    $('#year').textContent=new Date().getFullYear();
    $('#btn-start').onclick=async()=>{await startMusic();play('coin');show(1);};
    $('#btn-quiz').onclick=()=>{let ok=0;$$('.q').forEach(q=>{const ans=q.dataset.answer;const picked=$('input[type=radio]:checked',q)?.value;$$('.opt',q).forEach(o=>o.classList.remove('correct','wrong'));if(picked){const label=$(`input[value="${picked}"]`,q).closest('.opt');if(picked===ans){label.classList.add('correct');ok++;}else label.classList.add('wrong');}});const result=$('#quiz-result');if(ok===6){play('open');result.textContent="Perfect score! 🎉 Onward!";setTimeout(()=>show(2),800);}else{play('error');result.textContent=`You got ${ok}/6 — so close! Try again ❤️`;}};    
    const questMap=$('#questMap');let pos={x:0,y:0};const msgs={'0,0':'“You’re my favorite adventure buddy.”','3,0':'“We keep leveling up together.”','5,0':'“I choose you. Always.”'};const goal={x:7,y:0};
    function buildQuest(){questMap.innerHTML='';for(let i=0;i<16;i++){const x=i%8,y=Math.floor(i/8);const t=document.createElement('div');t.className='tile';if(x===goal.x&&y===goal.y)t.classList.add('goal');t.dataset.x=x;t.dataset.y=y;questMap.appendChild(t);}pos={x:0,y:0};drawSprite();$('#qMsg').textContent=msgs['0,0'];}
    function tileAt(x,y){return $(`.tile[data-x="${x}"][data-y="${y}"]`,questMap);}function drawSprite(){$$('.sprite',questMap).forEach(s=>s.remove());const t=tileAt(pos.x,pos.y);const s=document.createElement('div');s.className='sprite';t.appendChild(s);}
    function move(dx,dy){const nx=pos.x+dx,ny=pos.y+dy;if(nx<0||ny<0||nx>=8||ny>=2){play('error');return;}pos={x:nx,y:ny};play('coin');drawSprite();const key=`${pos.x},${pos.y}`;if(msgs[key])$('#qMsg').textContent=msgs[key];if(pos.x===goal.x&&pos.y===goal.y){$('#qMsg').textContent='Portal unlocked! ➜ Final Reveal';setTimeout(()=>{play('open');show(3);},500);}}
    $('#up').onclick=()=>move(0,-1);$('#down').onclick=()=>move(0,1);$('#left').onclick=()=>move(-1,0);$('#right').onclick=()=>move(1,0);$('#qReset').onclick=()=>{play('coin');buildQuest();};$('#qHint').onclick=()=>alert('Hint: Scoot right across the path to the glowing tile!');
    const questObs=new MutationObserver(()=>{if($('#screen-quest').classList.contains('active'))buildQuest();});questObs.observe(document.body,{subtree:true,attributes:true,attributeFilter:['class']});
    $$('.box').forEach(b=>b.onclick=()=>{const g=$('.gift',b);const l=$('.lid',b);if(g.hasAttribute('hidden')){g.removeAttribute('hidden');b.classList.add('revealed');l.style.display='none';play('open');}else{g.toggleAttribute('hidden');b.classList.toggle('revealed');l.style.display=g.hasAttribute('hidden')?'flex':'none';}});
    $('#btn-end').onclick=()=>{const all=$$('.box').every(b=>!$('.gift',b).hasAttribute('hidden'));if(!all){play('error');alert('Reveal all four gifts first!');return;}play('open');alert(`Your Gifts:\n\n• Beach Fossils Concert\n• Piano Café + 2-Night Stay\n• Pokémon Card\n• Hand-made DIY Surprise`);};
    (async()=>{if(!bgmOn)bgMusic.pause();})();
    // ---- Mobile viewport fix (handles iOS URL bar) ----
function setVH() {
  document.documentElement.style.setProperty('--vh', `${window.innerHeight * 0.01}px`);
}
window.addEventListener('resize', setVH, { passive: true });
setVH();

    function show(i){
  $$('.screen').forEach(el=>el.classList.remove('active'));
  $(`#screen-${screens[i]}`).classList.add('active');

  // HUD level (welcome shows 1)
  $('#level').textContent = (i === 0) ? 1 : i;

  // Only center the welcome screen; others start at top
  document.body.style.alignItems = (i === 0) ? 'center' : 'flex-start';

  // Hard scroll reset (covers iOS quirks)
  window.scrollTo(0, 0);
  document.documentElement.scrollTop = 0;
  document.body.scrollTop = 0;

  current = i;
}
  </script>
</body>
</html>
